#!/usr/bin/env python3
"""
Script para conectar ao RDS sem instalar MySQL client
"""

print('ğŸ—„ï¸ CONECTANDO AO RDS SEM MYSQL CLIENT')
print('=' * 60)

print('âŒ PROBLEMA IDENTIFICADO:')
print('   No match for argument: mysql')
print()
print('ğŸ’¡ EXPLICAÃ‡ÃƒO:')
print('   No Amazon Linux 2023, o cliente MySQL nÃ£o estÃ¡ disponÃ­vel')
print('   Mas podemos usar Python para conectar ao RDS!')
print()

print('âœ… SOLUÃ‡ÃƒO: USAR PYTHON PARA CONECTAR')
print('=' * 50)
print('ğŸ”§ VANTAGENS:')
print('   - âœ… Python jÃ¡ estÃ¡ instalado')
print('   - âœ… mysql-connector-python jÃ¡ estÃ¡ instalado')
print('   - âœ… NÃ£o precisa instalar nada')
print('   - âœ… Funciona perfeitamente')
print()

print('ğŸ¯ PASSO 1: TESTAR CONEXÃƒO COM PYTHON')
print('=' * 50)
print('1. ğŸ“ Criar script de teste')
print('   nano test_rds_connection.py')
print()
print('2. ğŸ”§ ConteÃºdo do script:')
print('   import mysql.connector')
print('   import os')
print('   ')
print('   try:')
print('       conn = mysql.connector.connect(')
print('           host="mercadolivre-db.xxxxxxxxxxxx.sa-east-1.rds.amazonaws.com",')
print('           user="admin",')
print('           password="MercadoLivre2024!",')
print('           port=3306,')
print('           ssl_disabled=False')
print('       )')
print('       print("âœ… ConexÃ£o com RDS bem-sucedida!")')
print('       conn.close()')
print('   except Exception as e:')
print('       print(f"âŒ Erro na conexÃ£o: {e}")')
print()
print('3. ğŸš€ Executar teste')
print('   python3.11 test_rds_connection.py')
print()

print('ğŸ¯ PASSO 2: CRIAR BANCO DE DADOS')
print('=' * 50)
print('1. ğŸ“ Criar script para criar banco')
print('   nano create_database.py')
print()
print('2. ğŸ”§ ConteÃºdo do script:')
print('   import mysql.connector')
print('   ')
print('   try:')
print('       conn = mysql.connector.connect(')
print('           host="mercadolivre-db.xxxxxxxxxxxx.sa-east-1.rds.amazonaws.com",')
print('           user="admin",')
print('           password="MercadoLivre2024!",')
print('           port=3306,')
print('           ssl_disabled=False')
print('       )')
print('       cursor = conn.cursor()')
print('       cursor.execute("CREATE DATABASE IF NOT EXISTS sistema_ml")')
print('       cursor.execute("USE sistema_ml")')
print('       print("âœ… Banco sistema_ml criado com sucesso!")')
print('       conn.close()')
print('   except Exception as e:')
print('       print(f"âŒ Erro: {e}")')
print()
print('3. ğŸš€ Executar script')
print('   python3.11 create_database.py')
print()

print('ğŸ¯ PASSO 3: CONFIGURAR APLICAÃ‡ÃƒO')
print('=' * 50)
print('1. ğŸ“ Editar arquivo .env')
print('   nano /home/ec2-user/mercadolivre-app/.env')
print()
print('2. ğŸ”„ Atualizar configuraÃ§Ãµes:')
print('   DB_HOST=mercadolivre-db.xxxxxxxxxxxx.sa-east-1.rds.amazonaws.com')
print('   DB_USER=admin')
print('   DB_PASSWORD=MercadoLivre2024!')
print('   DB_NAME=sistema_ml')
print('   DB_PORT=3306')
print('   DB_SSL_MODE=REQUIRED')
print()
print('3. ğŸ’¾ Salvar arquivo')
print('   Ctrl+X, Y, Enter')
print()

print('ğŸ¯ PASSO 4: REINICIAR APLICAÃ‡ÃƒO')
print('=' * 50)
print('1. ğŸš€ Reiniciar serviÃ§os')
print('   sudo systemctl restart flask-app')
print('   sudo systemctl restart nginx')
print()
print('2. âœ… Verificar status')
print('   sudo systemctl status flask-app')
print('   sudo systemctl status nginx')
print()
print('3. ğŸ“‹ Verificar logs')
print('   sudo journalctl -u flask-app -f')
print()

print('ğŸš¨ ALTERNATIVA: INSTALAR MYSQL CLIENT VIA DOCKER')
print('=' * 60)
print('ğŸ’¡ DICA: Se quiser usar mysql client:')
print()
print('1. ğŸ“¦ Instalar Docker')
print('   sudo yum install docker -y')
print('   sudo systemctl start docker')
print('   sudo systemctl enable docker')
print()
print('2. ğŸ³ Executar MySQL client no Docker')
print('   sudo docker run -it --rm mysql:8.0 mysql \\')
print('     -h mercadolivre-db.xxxxxxxxxxxx.sa-east-1.rds.amazonaws.com \\')
print('     -u admin -p')
print()

print('ğŸ¯ RESUMO:')
print('=' * 30)
print('âœ… Problema: MySQL client nÃ£o disponÃ­vel')
print('âœ… SoluÃ§Ã£o 1: Usar Python (recomendado)')
print('âœ… SoluÃ§Ã£o 2: Usar Docker')
print('âœ… RecomendaÃ§Ã£o: Python Ã© mais simples')
print()

print('ğŸš€ PRÃ“XIMOS PASSOS:')
print('=' * 30)
print('1. ğŸ§ª Testar conexÃ£o com Python')
print('2. ğŸ—„ï¸ Criar banco de dados')
print('3. âš™ï¸ Configurar aplicaÃ§Ã£o')
print('4. ğŸš€ Reiniciar aplicaÃ§Ã£o')
print('5. ğŸŒ Testar aplicaÃ§Ã£o')
print()

print('ğŸ‰ APÃ“S CONFIGURAR:')
print('=' * 30)
print('âœ… RDS: conectado')
print('âœ… Flask-app: active (running)')
print('âœ… Nginx: active (running)')
print('âœ… AplicaÃ§Ã£o: http://SEU_IP_PUBLICO')
print()

print('ğŸš€ SUA APLICAÃ‡ÃƒO ESTARÃ FUNCIONANDO!')
print('Python Ã© perfeito para conectar ao RDS!')
