#!/usr/bin/env python3
"""
Script para corrigir Security Group do RDS
"""

print('ğŸ”’ CORRIGINDO SECURITY GROUP DO RDS')
print('=' * 50)

print('âŒ PROBLEMA IDENTIFICADO:')
print('   Porta 3306 nÃ£o estÃ¡ acessÃ­vel')
print('   Security Group bloqueando conexÃ£o')
print()

print('âœ… SOLUÃ‡ÃƒO: CONFIGURAR SECURITY GROUP')
print('=' * 50)
print('ğŸ”§ PASSOS NO AWS CONSOLE:')
print()
print('1. ğŸŒ Acessar AWS Console')
print('   https://console.aws.amazon.com')
print()
print('2. ğŸ” Navegar para RDS')
print('   Services â†’ RDS â†’ Databases')
print()
print('3. ğŸ“‹ Selecionar seu banco')
print('   mercadolivre-db')
print()
print('4. ğŸ”’ Ir para Security Groups')
print('   Database â†’ Connectivity & security â†’ VPC security groups')
print()
print('5. âš™ï¸ Editar Security Group')
print('   Clique no Security Group')
print('   Actions â†’ Edit inbound rules')
print()
print('6. â• Adicionar regra')
print('   Type: MySQL/Aurora')
print('   Protocol: TCP')
print('   Port: 3306')
print('   Source: Custom')
print('   IP: 0.0.0.0/0 (ou IP do EC2: 172.31.4.248/32)')
print()
print('7. ğŸ’¾ Salvar regra')
print('   Save rules')
print()

print('ğŸ¯ CONFIGURAÃ‡ÃƒO RECOMENDADA:')
print('=' * 40)
print('ğŸ“‹ REGRA 1 (Mais Segura):')
print('   Type: MySQL/Aurora')
print('   Protocol: TCP')
print('   Port: 3306')
print('   Source: 172.31.4.248/32 (IP do EC2)')
print()
print('ğŸ“‹ REGRA 2 (Menos Segura):')
print('   Type: MySQL/Aurora')
print('   Protocol: TCP')
print('   Port: 3306')
print('   Source: 0.0.0.0/0 (Qualquer IP)')
print()

print('ğŸš¨ IMPORTANTE:')
print('=' * 20)
print('âš ï¸ Regra 1 Ã© mais segura (apenas EC2)')
print('âš ï¸ Regra 2 permite acesso de qualquer lugar')
print('âœ… RecomendaÃ§Ã£o: Use Regra 1')
print()

print('ğŸ” VERIFICAR IP DO EC2:')
print('=' * 30)
print('No EC2, execute:')
print('   curl -s http://169.254.169.254/latest/meta-data/public-ipv4')
print('   curl -s http://169.254.169.254/latest/meta-data/local-ipv4')
print()

print('â±ï¸ TEMPO DE PROPAGAÃ‡ÃƒO:')
print('=' * 30)
print('â° Security Group: 1-2 minutos')
print('â° DNS: 1-5 minutos')
print('â° Total: 2-7 minutos')
print()

print('ğŸ§ª APÃ“S CONFIGURAR:')
print('=' * 30)
print('1. â³ Aguardar 2-3 minutos')
print('2. ğŸ§ª Testar conexÃ£o:')
print('   python3.11 test_rds_connection.py')
print('3. ğŸ—„ï¸ Criar banco:')
print('   python3.11 create_database.py')
print()

print('ğŸ¯ RESUMO:')
print('=' * 20)
print('âœ… Problema: Security Group')
print('âœ… SoluÃ§Ã£o: Configurar regra')
print('âœ… Porta: 3306')
print('âœ… Fonte: IP do EC2')
print()
print('ğŸš€ CONFIGURE O SECURITY GROUP E TESTE NOVAMENTE!')
