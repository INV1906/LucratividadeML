#!/usr/bin/env python3
"""
Script para corrigir problemas identificados na EC2
"""

print('ğŸ”§ CORRIGINDO PROBLEMAS IDENTIFICADOS NA EC2')
print('=' * 60)

print('âŒ PROBLEMAS IDENTIFICADOS:')
print('   1. IndentationError no app.py (linha 380-381)')
print('   2. MySQL nÃ£o estÃ¡ instalado (mysqld.service not found)')
print()

print('âœ… SOLUÃ‡ÃƒO 1: CORRIGIR ERRO DE INDENTAÃ‡ÃƒO')
print('=' * 50)
print('ğŸ” PROBLEMA:')
print('   IndentationError: expected an indented block after \'if\' statement on line 380')
print()
print('ğŸ”§ SOLUÃ‡ÃƒO:')
print('   1. ğŸ“ Editar o arquivo app.py:')
print('      nano /home/ec2-user/mercadolivre-app/app.py')
print()
print('   2. ğŸ” Ir para a linha 380-381')
print('   3. âœï¸ Corrigir a indentaÃ§Ã£o:')
print('      # Linha 380: if result[\'sucesso\']:')
print('      # Linha 381:     import_status[\'vendas\'][\'sucesso\'] += 1')
print('      # (Adicionar 4 espaÃ§os antes da linha 381)')
print()
print('   4. ğŸ’¾ Salvar: Ctrl+X, Y, Enter')
print()

print('âœ… SOLUÃ‡ÃƒO 2: INSTALAR MYSQL')
print('=' * 50)
print('ğŸ” PROBLEMA:')
print('   Unit mysqld.service could not be found')
print()
print('ğŸ”§ SOLUÃ‡ÃƒO:')
print('   1. ğŸ“¦ Instalar MySQL:')
print('      sudo yum install mysql-server -y')
print()
print('   2. ğŸš€ Iniciar MySQL:')
print('      sudo systemctl start mysqld')
print('      sudo systemctl enable mysqld')
print()
print('   3. ğŸ”§ Configurar MySQL:')
print('      sudo mysql_secure_installation')
print('      # Responda: Y, Y, N, Y, Y')
print()
print('   4. ğŸ—„ï¸ Criar banco de dados:')
print('      sudo mysql -u root -p')
print('      # No MySQL:')
print('      CREATE DATABASE sistema_ml;')
print('      CREATE USER "admin"@"%" IDENTIFIED BY "2154";')
print('      GRANT ALL PRIVILEGES ON sistema_ml.* TO "admin"@"%";')
print('      FLUSH PRIVILEGES;')
print('      EXIT;')
print()

print('ğŸ¯ COMANDOS COMPLETOS PARA EXECUTAR:')
print('=' * 50)
print('# 1. Corrigir indentaÃ§Ã£o no app.py')
print('nano /home/ec2-user/mercadolivre-app/app.py')
print('# Ir para linha 380-381 e corrigir indentaÃ§Ã£o')
print()
print('# 2. Instalar MySQL')
print('sudo yum install mysql-server -y')
print('sudo systemctl start mysqld')
print('sudo systemctl enable mysqld')
print('sudo mysql_secure_installation')
print()
print('# 3. Criar banco de dados')
print('sudo mysql -u root -p')
print('# Executar comandos SQL acima')
print()
print('# 4. Reiniciar serviÃ§os')
print('sudo systemctl restart flask-app')
print('sudo systemctl restart nginx')
print()
print('# 5. Verificar status')
print('sudo systemctl status nginx')
print('sudo systemctl status flask-app')
print('sudo systemctl status mysqld')
print()

print('ğŸ” VERIFICAR LOGS:')
print('=' * 30)
print('ğŸ“‹ Ver logs da aplicaÃ§Ã£o:')
print('   sudo journalctl -u flask-app -f')
print()
print('ğŸ“‹ Ver logs do MySQL:')
print('   sudo journalctl -u mysqld -f')
print()
print('ğŸ“‹ Ver logs do Nginx:')
print('   sudo journalctl -u nginx -f')
print()

print('ğŸš¨ SOLUÃ‡ÃƒO DE PROBLEMAS:')
print('=' * 40)
print('âŒ Se ainda houver erro de indentaÃ§Ã£o:')
print('   1. Verificar se todas as linhas estÃ£o corretas')
print('   2. Usar espaÃ§os em vez de tabs')
print('   3. Verificar se nÃ£o hÃ¡ caracteres especiais')
print()
print('âŒ Se MySQL nÃ£o conectar:')
print('   1. Verificar se MySQL estÃ¡ rodando')
print('   2. Verificar se o banco existe')
print('   3. Verificar se o usuÃ¡rio tem permissÃµes')
print()
print('âŒ Se a aplicaÃ§Ã£o nÃ£o carregar:')
print('   1. Verificar logs da aplicaÃ§Ã£o')
print('   2. Verificar se todas as dependÃªncias estÃ£o instaladas')
print('   3. Verificar se o arquivo .env estÃ¡ correto')
print()

print('ğŸ¯ RESUMO DOS PASSOS:')
print('=' * 30)
print('1. ğŸ”§ Corrigir indentaÃ§Ã£o no app.py')
print('2. ğŸ“¦ Instalar MySQL')
print('3. ğŸ—„ï¸ Configurar banco de dados')
print('4. ğŸš€ Reiniciar serviÃ§os')
print('5. âœ… Verificar status')
print('6. ğŸŒ Testar aplicaÃ§Ã£o')
print()

print('ğŸ‰ APÃ“S CORRIGIR:')
print('=' * 30)
print('âœ… Nginx: active (running)')
print('âœ… Flask-app: active (running)')
print('âœ… MySQL: active (running)')
print('âœ… AplicaÃ§Ã£o: http://SEU_IP_PUBLICO')
print()

print('ğŸš€ SUA APLICAÃ‡ÃƒO ESTARÃ FUNCIONANDO!')
print('SÃ³ precisa corrigir esses dois problemas!')
